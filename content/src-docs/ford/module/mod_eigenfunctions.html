<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Legolas is a novel finite-element based code that allows for realistic MHD spectroscopy of one-dimensional plasmas.">
    
    <meta name="author" content="" >
    <link rel="icon" href="../favicon.png">

    <title>mod_eigenfunctions &ndash; Legolas v. 1.1.0 - develop</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">Legolas v. 1.1.0 - develop </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
        
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/legolas.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/legolas.html">Program</a></li>

          </ul>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>mod_eigenfunctions 
    <small>Module</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 1.6% of total for modules and submodules.">133 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/mod_eigenfunctions.f08"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/mod_eigenfunctions.f08.html'>mod_eigenfunctions.f08</a></li>
    
  
     <li class="active">mod_eigenfunctions</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 



<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-0">Variables</a></h3></div>
  <div id="vars-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/mod_eigenfunctions.html#variable-ef_grid">ef_grid</a>
      
      <a class="list-group-item" href="../module/mod_eigenfunctions.html#variable-ef_names">ef_names</a>
      
      <a class="list-group-item" href="../module/mod_eigenfunctions.html#variable-ef_array">ef_array</a>
      
    </div>
  </div>
</div>













<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-0">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-0" class="panel-collapse collapse">
      
      <a class="list-group-item" href="../module/mod_eigenfunctions.html#proc-initialise_eigenfunctions">initialise_eigenfunctions</a>
      
      <a class="list-group-item" href="../module/mod_eigenfunctions.html#proc-calculate_eigenfunctions">calculate_eigenfunctions</a>
      
      <a class="list-group-item" href="../module/mod_eigenfunctions.html#proc-get_eigenfunction">get_eigenfunction</a>
      
      <a class="list-group-item" href="../module/mod_eigenfunctions.html#proc-get_spline">get_spline</a>
      
      <a class="list-group-item" href="../module/mod_eigenfunctions.html#proc-transform_eigenfunction">transform_eigenfunction</a>
      
      <a class="list-group-item" href="../module/mod_eigenfunctions.html#proc-eigenfunctions_clean">eigenfunctions_clean</a>
      
    </div>
  </div>
</div>










</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <p>This module composes the eigenfunctions based on the eigenvectors
 coming out of the solver routines. Assembling the eigenfunctions is needed
 because of the finite element matrix representation.
 In every interval of the base grid <script type="math/tex">(i, i+1)</script> eigenfunctions are saved at the
 left and right edges, as well as in the centre of the interval.
 This results in eigenfunction arrays with a size <script type="math/tex">2*gridpts - 1</script>.</p>
      <br>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
  <ul class="list-inline">
    
    <li><a href='../module/mod_global_variables.html'>mod_global_variables</a></li>
    
    <li><a href='../module/mod_types.html'>mod_types</a></li>
    
  </ul>
      </li>
      
      
      
      </ul>
    </div>
    

    
    

    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 



<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-1">Variables</a></h3></div>
  <div id="vars-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/mod_eigenfunctions.html#variable-ef_grid">ef_grid</a>
      
      <a class="list-group-item" href="../module/mod_eigenfunctions.html#variable-ef_names">ef_names</a>
      
      <a class="list-group-item" href="../module/mod_eigenfunctions.html#variable-ef_array">ef_array</a>
      
    </div>
  </div>
</div>













<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-1">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-1" class="panel-collapse collapse">
      
      <a class="list-group-item" href="../module/mod_eigenfunctions.html#proc-initialise_eigenfunctions">initialise_eigenfunctions</a>
      
      <a class="list-group-item" href="../module/mod_eigenfunctions.html#proc-calculate_eigenfunctions">calculate_eigenfunctions</a>
      
      <a class="list-group-item" href="../module/mod_eigenfunctions.html#proc-get_eigenfunction">get_eigenfunction</a>
      
      <a class="list-group-item" href="../module/mod_eigenfunctions.html#proc-get_spline">get_spline</a>
      
      <a class="list-group-item" href="../module/mod_eigenfunctions.html#proc-transform_eigenfunction">transform_eigenfunction</a>
      
      <a class="list-group-item" href="../module/mod_eigenfunctions.html#proc-eigenfunctions_clean">eigenfunctions_clean</a>
      
    </div>
  </div>
</div>










    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    <section>
    <h2>Variables</h2>
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Visibility</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ef_grid"></span>real(kind=dp),</td>
  
  <td>public,</td>
  <td>allocatable</td><td>::</td>
  <td><strong>ef_grid</strong>(:)</td><td></td><td></td><td><p>grid to which the eigenfunction is assembled</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ef_names"></span>character(len=str_len_arr),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>ef_names</strong>(nb_eqs)</td><td></td><td></td><td><p>array containing the eigenfunction names as strings</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ef_array"></span>type(<a href='../type/ef_type.html'>ef_type</a>),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>ef_array</strong>(nb_eqs)</td><td></td><td></td><td><p>type containig all eigenfunctions</p></td>
  
</tr>

</tbody>
</table>

    </section>
    <br>
    
    
    
    
    

    
    
    
    
    

    
    <section>
    <h2>Subroutines</h2>
    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-initialise_eigenfunctions"></span><h3>
public subroutine <a href='../proc/initialise_eigenfunctions.html'>initialise_eigenfunctions</a>(nb_evs)
    
    
   
</h3></div>
  <div class="panel-body">
       
    







<p>Main initialisations of this module.
 Allocates and initialises the eigenfunction grid, types and names.
 Passing the optional argument <tt>nb_evs</tt> sets the number of eigenvalues
 that are calculated and limits the size of the eigenfunction arrays accordingly.
 This routine is only called if <tt>write_eigenfunctions = .true.</tt>.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>nb_evs</strong></td><td><p>the number of eigenvalues that are calculated, defaults to all (matrix dim)</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-calculate_eigenfunctions"></span><h3>
public subroutine <a href='../proc/calculate_eigenfunctions.html'>calculate_eigenfunctions</a>(vr)
    
    
   
</h3></div>
  <div class="panel-body">
       
    







<p>Calculates the eigenfunctions for every eigenvalue and variable,
 based on the right eigenvectors. The eigenfunctions are transformed
 back to their 'actual' values</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>complex(kind=dp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>vr</strong>(:,:)</td><td><p>the matrix of right eigenvectors</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-get_eigenfunction"></span><h3>
private subroutine <a href='../proc/get_eigenfunction.html'>get_eigenfunction</a>(ef_idx, eigenvector, Y)
    
    
   
</h3></div>
  <div class="panel-body">
       
    







<p>Calculates a single eigenfunction based on an eigenvector.
 Assembles the eigenfunction corresponding to <tt>ef_idx</tt> and the
 given eigenvector. The eigenvector supplied is the one
 corresponding to one particular eigenvalue.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ef_idx</strong></td><td><p>the index of the variable in the state vector</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>complex(kind=dp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>eigenvector</strong>(matrix_gridpts)</td><td><p>the eigenvector for this particular eigenvalue</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>complex(kind=dp),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Y</strong>(ef_gridpts)</td><td><p>the assembled eigenfunction</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-get_spline"></span><h3>
private subroutine <a href='../proc/get_spline.html'>get_spline</a>(ef_idx, r, r_lo, r_hi, spline)
    
    
   
</h3></div>
  <div class="panel-body">
       
    







<p>Retrieves the spline for a particular variable by
 calling the correct finite element basis function depending on the
 variable passed.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ef_idx</strong></td><td><p>the index of the variable in the state vector</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>r</strong></td><td><p>the current position in the grid</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>r_lo</strong></td><td><p>left edge of the current grid interval</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>r_hi</strong></td><td><p>right edge of the current grid interval</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dp),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>spline</strong>(4)</td><td><p>the finite element basis functions for this grid position</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-transform_eigenfunction"></span><h3>
private subroutine <a href='../proc/transform_eigenfunction.html'>transform_eigenfunction</a>(ef_idx, ef_values)
    
    
   
</h3></div>
  <div class="panel-body">
       
    







<p>Re-transformation of the eigenfunction.
 Transforms the eigenfunction back to its 'actual' value.
 For example, <script type="math/tex">\rho</script> is defined as <script type="math/tex">\varepsilon\rho</script> in the equations,
 in this case the eigenfunction is divided by the scale factor.
 </p><a href="../proc/transform_eigenfunction.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ef_idx</strong></td><td><p>index of the variable in the state vector</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>complex(kind=dp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ef_values</strong>(ef_gridpts)</td><td><p>eigenfunction values, transformed on exit</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-eigenfunctions_clean"></span><h3>
public subroutine <a href='../proc/eigenfunctions_clean.html'>eigenfunctions_clean</a>()
    
    
   
</h3></div>
  <div class="panel-body">
       
    







<p>Cleaning routine, deallocates the eigenfunction arrays.</p>
    
    <h4>Arguments</h4>
    
      <em>None</em>
    
    

  </div>
  </div>

    
    </section>    
    <br>
    
    
    
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> Legolas v. 1.1.0 - develop was developed by </p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    
  </body>
</html>